<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <style media="screen">
      canvas {
        border: 1px solid black;
        display: flex;
        margin: auto;
        background-image: url('assets/background.png');
        background-size: 150%;
        background-position: bottom;

      }
    </style>

    <script type="text/javascript">

    document.addEventListener('DOMContentLoaded', () => {

      let canvas = document.getElementById('canvas');
      let ctx = canvas.getContext('2d');


      window.setInterval(() => {
        anthony.spriteAnimationCounter += 1;

        if (Object.values(anthony.move).every((bool) => bool === false)) {
          anthony.setIdleDirection(anthony.direction)
          anthony.direction = "idle";
        }
        anthony.draw(anthony.direction);
      }, 50)


// PLAYER ========================================================================================================

      const anthonyCharImg = new Image();
      anthonyCharImg.src = 'assets/rondsprite.png';


      class Player {
        constructor(options) {
          this.context = options.context,
          this.width = options.width,
          this.height = options.height,
          this.image = options.image,
          this.dx = this.context.canvas.width - 1000,
          this.dy = this.context.canvas.height / 2,
          this.numberOfFrames = options.numberOfFrames || 1,
          this.frameIndex = 0,
          this.spriteAnimationCounter = 0,
          this.animationSelector = 1
          this.move = {
            left: false,
            right: false
          }
          this.direction = "idle"
        }

        setIdleDirection(direction) {
          if(direction === "right") {
            this.animationSelector = 1;
          } else if (direction === "left") {
            this.animationSelector = 5;
          }
        }

        draw(direction) {
          this.context.clearRect(this.dx, this.dy, this.width / this.numberOfFrames, this.height / 6);

          switch(direction) {
            case "left":  // left
              this.dx -= 10;
              break;
            case "right": // right
              this.dx += 10;
              break;
          }

          let frameWidth = this.width / 8;
          let frameHeight = this.height / 8;

          let animationMod = this.spriteAnimationCounter % 8;

          this.context.drawImage(
            this.image,
            animationMod * frameWidth, // source x
            anthony.animationSelector * frameHeight, //source y
            frameWidth, //source width
            frameHeight, // source height
            this.dx, // destination x
            this.dy, // destination y
            this.width / this.numberOfFrames, // destination width
            this.height / 8 // destination height
          );
        }

        render() {
          this.image.onload = () => {
            this.context.drawImage(
              this.image,
              this.frameIndex * this.width / this.numberOfFrames, // source x
              0, //source y
              this.width / this.numberOfFrames, //source width
              this.height / 8, // source height
              this.dx, // destination x
              this.dy, // destination y
              this.width / this.numberOfFrames, // destination width
              this.height / 8 // destination height
            );
          }
        }

      }

      const anthonyCharOptions = {
        context: ctx,
        width: 3197,
        height: 2656,
        image: anthonyCharImg,
        numberOfFrames: 8
      }

      const anthony = new Player (anthonyCharOptions);
      anthony.render();


      document.addEventListener('keydown', (e) => {
        switch(e.keyCode) {
          case 37:  // left
            anthony.move.left = true;
            anthony.direction = "left"
            anthony.animationSelector = 4;
            break;
          case 39: // right
            anthony.move.right = true;
            anthony.direction = "right"
            anthony.animationSelector = 0;
            break;
          case 83: //s punch
            anthony.animationSelector = 2;
            break;
      }
    })

    document.addEventListener('keyup', (e) => {

      switch(e.keyCode) {
        case 37:  // left
          anthony.move.left = false;
          break;
        case 39: // right
          anthony.move.right = false;
          break;
        case 83: //s punch
          anthony.move.punch = false;
          break;
      }
    })

// PLAYER ========================================================================================================


// Enemy ========================================================================================================





// Enemy ========================================================================================================


})

    </script>
  </head>
  <body>
    <canvas id="canvas" width="1035" height="700"></canvas>
  </body>
</html>
